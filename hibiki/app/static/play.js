// Copyright 2016 ICFP Programming Contest 2016 Organizers
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

function fold(l, z, f) {
    for (var i = 0; i < l.length; i++) z = f(z, l[i]);
    return z;
}

function push(l, x) {
    l = l.concat();
    l.push(x);
    return l;
}

var problems={sample:[[[[0,0],[1,0],[.5,.5],[0,.5]]],[],[[[.5,.5],[0,0]],[[0,0],[1,0]],[[1,0],[.5,.5]],[[.5,.5],[0,.5]],[[0,.5],[0,0]]]],small_square:[[[[1/7,1/7],[6/7,1/7],[6/7,6/7],[1/7,6/7]]],[],[[[1/7,1/7],[1/7,6/7]],[[3/7,1/7],[3/7,6/7]],[[6/7,1/7],[6/7,6/7]],[[1/7,1/7],[6/7,1/7]],[[1/7,3/7],[6/7,3/7]],[[1/7,6/7],[6/7,6/7]]]],decagon:[[[[27/68,13/71],[41/68,13/71],[57/74,24/79],[54/65,.5],[57/74,55/79],[41/68,58/71],[27/68,58/71],[17/74,55/79],[11/65,.5],[17/74,24/79]]],[],[[[57/74,24/79],[54/65,.5]],[[.7286845433607295,.5814599800650041],[57/74,55/79]],[[41/68,13/71],[57/74,24/79]],[[.738099142769453,.5812537190347948],[.7731811856604474,.686762221196457]],[[.5232865147639836,13/71],[.5556742304919766,.28637395263026993]],[[.4100097080204199,13/71],[.7631753433054331,.7013202890912382]],[[.4887568165388007,13/71],[.5082005270056249,.25143751407940623]],[[.6487944987736216,.5513562752397606],[.7631753433054331,.7013202890912382]],[[.40998625588783894,13/71],[.45243450937087176,.31076081630311847]],[[.4175447549894666,13/71],[.5556742304919766,.28637395263026993]],[[27/68,13/71],[.5,607710/2361389]],[[.40934780078982536,.18406984881326252],[.5082005270056249,.25143751407940623]],[[17/74,24/79],[.27131545663927037,.4185400199349959]],[[.35600602675372783,.6934359902363784],[27/68,58/71]],[[.23682465669456684,.2986797109087618],[.5899902919795801,58/71]],[[.23682465669456684,.2986797109087618],[.4622464191439451,.5942287816011118]],[[11/65,.5],[17/74,55/79]],[[.7056568857567658,.5079860847641432],[.8061745685831988,.5797622793196576]],[[.7339258374391964,.5959216596084586],[1671681/2117362,45/71]],[[17/74,24/79],[11/65,.5]],[[.40998625588783894,13/71],[.4074854824205284,.19061961487172313]],[[.4887568165388007,13/71],[.45243450937087176,.31076081630311847]],[[48223/149110,45/71],[.29062111550001396,.7401250898970351]],[[.5232865147639836,13/71],[.5,607710/2361389]],[[27/68,13/71],[41/68,13/71]],[[.1938254314168011,.4202377206803424],[.45027511755701616,.6033595560482007]],[[.5556742304919766,.28637395263026993],[.45027511755701616,.6033595560482007]],[[.738099142769453,.5812537190347948],[.7339258374391964,.5959216596084586]],[[.4100097080204199,13/71],[.40934780078982536,.18406984881326252]],[[.7056568857567658,.5079860847641432],[41/68,58/71]],[[54/65,.5],[57/74,55/79]],[[48223/149110,45/71],[.5906521992101746,.8159301511867375]],[[27/68,13/71],[17/74,24/79]],[[.4175447549894666,13/71],[.4074854824205284,.19061961487172313]],[[57/74,24/79],[.45243450937087176,.31076081630311847]],[[17/74,55/79],[27/68,58/71]],[[.27131545663927037,.4185400199349959],[11/65,.5]],[[41/68,13/71],[.5,607710/2361389]],[[.27131545663927037,.4185400199349959],[.1938254314168011,.4202377206803424]],[[.5906521992101746,.8159301511867375],[.5899902919795801,58/71]],[[.8061745685831988,.5797622793196576],[.7286845433607295,.5814599800650041]],[[.4622464191439451,.5942287816011118],[.45027511755701616,.6033595560482007]],[[.35600602675372783,.6934359902363784],[.29062111550001396,.7401250898970351]],[[48223/149110,45/71],[1671681/2117362,45/71]],[[.7056568857567658,.5079860847641432],[.6487944987736216,.5513562752397606]],[[.35600602675372783,.6934359902363784],[17/74,55/79]],[[54/65,.5],[.7286845433607295,.5814599800650041]],[[.7731811856604474,.686762221196457],[.7598354166911885,.6969413320806329]],[[27/68,58/71],[41/68,58/71]],[[57/74,55/79],[41/68,58/71]]]],donut:[[[[0,1/8],[1/8,0],[.25,0],[3/8,1/8],[3/8,.25],[.25,3/8],[1/8,3/8],[0,.25]]],[[[1/8,1/8],[1/8,.25],[.25,.25],[.25,1/8]]],[[[3/8,1/8],[0,1/8]],[[1/8,3/8],[1/8,0]],[[1/8,0],[.25,0]],[[.25,3/8],[1/8,3/8]],[[.25,0],[3/8,1/8]],[[3/8,.25],[.25,3/8]],[[0,.25],[3/8,.25]],[[3/8,.25],[3/8,1/8]],[[.25,0],[.25,3/8]],[[1/8,3/8],[0,.25]],[[0,.25],[0,1/8]],[[1/8,0],[0,1/8]]]],crane:[[[[.16,.72],[1831/6745,4749/6745],[49/195,224/585],[.35,.35],[224/585,49/195],[.84,.28],[448/895,294/895],[168/295,441/1180],[.7,.7],[441/1180,168/295],[294/895,448/895],[.3,.7],[277/1015,738/1015]]],[],[[[5603/14650,2777/7325],[39221/111815,38878/111815]],[[112/265,147/530],[5603/14650,2777/7325]],[[14/41,147/410],[.7,.7]],[[.7,.7],[168/295,441/1180]],[[.35,.35],[.84,.28]],[[49/195,224/585],[.35,.35]],[[147/415,28/83],[21/58,10/29]],[[39221/111815,38878/111815],[.84,.28]],[[.35,.35],[.3,.7]],[[5603/14650,2777/7325],[168/295,441/1180]],[[.5,21/64],[.5,.5]],[[21/58,10/29],[116/273,29/104]],[[2777/7325,5603/14650],[38878/111815,39221/111815]],[[21/64,.5],[2777/7325,5603/14650]],[[112/265,147/530],[147/530,112/265]],[[224/585,49/195],[.84,.28]],[[28/83,147/415],[188/635,447/635]],[[116/273,29/104],[5603/14650,2777/7325]],[[277/1015,738/1015],[.3,.7]],[[147/410,14/41],[.7,.7]],[[50378/168335,117957/168335],[38878/111815,39221/111815]],[[5603/14650,2777/7325],[.5,21/64]],[[.84,.28],[147/415,28/83]],[[10/29,21/58],[28/83,147/415]],[[.7,.7],[441/1180,168/295]],[[168/295,441/1180],[224/585,49/195]],[[.16,.72],[188/635,447/635]],[[.5,.5],[21/64,.5]],[[49/195,224/585],[441/1180,168/295]],[[2777/7325,5603/14650],[147/530,112/265]],[[441/1180,168/295],[2777/7325,5603/14650]],[[50378/168335,117957/168335],[.16,.72]],[[29/104,116/273],[2777/7325,5603/14650]],[[224/585,49/195],[.35,.35]],[[29/104,116/273],[10/29,21/58]],[[.16,.72],[277/1015,738/1015]],[[.3,.7],[.16,.72]],[[.5,.5],[.35,.35]],[[49/195,224/585],[277/1015,738/1015]]]]};

eval(fold(fold(Array.apply(null,{length:418}),[fold(

"IPCIipFPPcICcFcPFIcfCIcIFPCPcCIiicpiPiCPfIcFPPfFPcicFfFIPPpFFIIpFcFIFPPPFICPcFFIpfPPPccPPPFIfPpFPpFpCIFFPPpFPpFiipIfIciiIpfPciPpFPcfFFiPiCPpcpCiPciPpFPpcPcppCcIfPFCFIfCFCCIiiFCpccPFCiIpFIfPcCiPFcIppicIPFfIcFPCfIcFPIIFpCppPfpfIfPIIIPcippiIfFPiifcFifpIpIFiIccfIpIPFippfciCcIfpiPIFIicPIifPCCFicPipFfPcpiPipIPiFfFPFfFfCIIIfpfcpPFfiPfpPicPfffcCcpfIipPCfcCPpfPpfIPiPicicPIIipPCCpffPpFFcfpcpcIffPPCPPPciPPIIpiIIpPiPcpcIfpPPcIfpIIfPiPciifPFCPccpCcipcfiIppPifICiPcFciIPcFPCpPCpIfcPIIfiIIfCPiIPFfCFPiFFffPfIiPiffPcPiIICiPFfIpCPFfPPiIfIPipPCpPFfPfIPiIPIIIpCIiiPciPipIpCcCIIfCIPCPiPIppPipcpCcfIiIcfFPIcIPciiFpIcCIpFPCfPiPIfICpicPffFCIfPPFfIcIIcFffCPciPPiIfpPifPPfIpcPpPIpFCiiIfCPPpIiIPpPIiPIfpPpPICiICiIcPcPcIcPfFiIipPIIPFPcPIccccIIfFcPiPPiPcCpfCCcFFcICcFFIipPipCcpPPCCciPifCcfPciIFciiCipIPiPciFIpCIipIicccCccCpPpIfCIfFfCifcPIiPpPciiIpIPIfppIIPpFpIFcpppICPPfpIpIpFpIifCpipfIciIfifpPpFPiiFfppfCcpFFccFIiicfFccFIfpIpFPifIicPciIfiIippCPIpCIfCIfFpCFPFIcPFPIfffIPCcPFfcCfPiCIpcIpiIifIpIIfPIicIfPppFPIcppCfpIpppIpCcFcifCICIPiPfpFPpPPpFPiCpiIPpCpiFPpPpiCIiIpipIiiifiIpIPIiccpIciccpfcCPipPicPfIpfFPCIIFFIpipfpicCpfiPPCicpfcppfcIpppcPPfFpcIPpFpcFcpCpcCcPFIPCPCPPiIicfIppPciPiIPCFPCpPCfciPIcIIfCPCpIfCPCfPiIPcFPccPiPPiiIfIfiCPpPiIPfICIffccccpPIfCIfCPciiIpPiPiIiccFfIcIfFPciIfIiFPcpiiFIPcfciIfFIPFffFFPfIPipiFiccFIpiIipiFcIpFIfIPicPCfPcCPipIfPPFfICCIFcPiPPFfcCCPCCcifIiFfFfICFPiPPpPIppipFffcipCPPfippIpcIpFIpiPipPfCPpIPfIfcIPffIpIcCccfFfCfIppPCCfcFPPpiiicciiifIfpiicIpiifPcfFifIIiPIfCcicIFCPiPIpCciCIpIIfpifffpCIicIfFcPiccpPiPIiffpiPIiPIiPIiPpFPcCfciPPPIpiPificcIfpcPCcCcfPIPpFIppcffIiCPciPiIccIPcificPCfPCpcfcPpPfIPPPpccPfiFIiiPipcccIcIIpCPCfIFccfpIfPcCFPFfIpcPFIccfciPPiPPiIPCfIIfcfpICiPcCPCpPiCPCpPiFPipIcFIpIcciIpCIpCPCCPFPPFPffpciFcFpPCFcFfIpIIifIpCIiPPciPIcPiPIppIiCPiPPiCPpFIiIIpcPiPIiPcIcIIIIPcPifPCFcifPCfPCfIFiPiPIifIpcPCFPIFICicfPfifcppcPpIipPciIfPIIpcfpPCiPipIFFPiPPipIiFffiIpifffIiCcffcCiIFPcIFPpFPipPfFPfiIiIIppPfFPcPPPCPPCfcfPcifccccPcPPIcIIFCIfpIpfcFIcciIcPPCpPifIpfIicPCfccIPciICCPCfPiFccCICiIpcPCpIpIPPpcIpccfIiiIicPiPPCFcfCPPPIPFPiPPiIPiccicIipcFCPiPIFpIiccFiIpiIipPPfIpfPifPpFcfIPiiPfIICiPPcPipIcIIfIPciPFfPFPIfFIicIIcPiPIpcIpicpIPiPcpFcipIfPIfiIfpPiPIppPiPPciPfPPipPfIcfcICCPpfPpfPiIPiIPCFPFPIipIiIIfCIiPPCCPPIcfiPiPIiIIipPipICCPiIPifIicIfiPppPiPPiPPPiIiIIpfIfCIfpPCCPIFIipIpiICiIciIfCIpiPipPfPPFFPpPIfpIpiIffIpiPCfPipPpFPpCPPFPpPIffPIPPfPPfPIfpIiPIPfPiPIiIIifPipPIcIpIIfFPCpPipPICIifPIpIfFPFIPIfPiIIciIfpIfiPFFPiPIiCPifIfFIpiPFCPCPPFpPFiIpfPFcPCIIiIPiIPipIfiIifIicIifIpCIfpPiIPcCPiIIcCPCiICiICCPfPICCPCcPfIICiPicPiFPpPIIfIicCicIfCIicCifPIPIppPpPIfpIicipPIpiIicIpFIpfIfiIfCIpCfFcPpPCipPpPIpCIicIppIpiPipCiCIfiCicIcIcfFPpPIfccFIPpPIpcIpIPPfPpPIifIicPPpCiFCiCIcIPpPIiICiIPpPPiFPicccpiCciCfPipIpfiCiIiFciiIpFCiPCpciCpiCCffFiCfiCFPfFcIPCpfiCIPcCcCCIpFfFiIfIfFpIpFcPcIfIiCPcifIpFPCpPCCIcIcPfiFfPIIPfPCppCpCPiiCpFcFPIpFPIIPCcIciCpIcifPpICpFPiIPIFPcCCpPffIiFfPCfCppiFCiFfcPiffPCpciFFIcIffCCCccCCIcIcCFficiCIiIfPCFcCCfiiIIIPifIpCPCPIpCIpICCfiICiCFcCICCiIfcciiiIFCCpIfccccICCICCfipICiCCCCCFPipIffciiCCIiIICCPfIfCiPfIiiCpfIpiPcfIfiPfIfIPCfPpIcpifFPcCCfIpIpCfIFfIffFIPiciPicccPfPPcpiIfciPIfIPcpCFciPpcCCffFIpCcccffPiPciCFIfIcIPPiIiCpICCffFffPIffCCPCFffIpCFifICCFpiPcciICFCCFfIfIfipiIIcccIfIPFfcpPfIIIfICFFiPCICCfIIIfCcPiPCFiIFiPFCFIiPpCIciPIPCpfIFCCciIFIfCPifiICCIfCIiPPcIiccpcCIpCCpIiccfPCCCcCFiCIfPfIcIfPifPpfPiiPPfiPfPpfiPiPPCICfPpCICiPPpccfPppccPccIfCPcFiIIcCFPIifPCCIFCIcIfcfPifIFiIcPccffIIfcCIIICCIfcfFCiPIciPCIPPFcCPfiPIfpciPFCPiPPifIiPCFfPFiCCIiCPipCPpIiCpcfpcicpPIppcfPPpIiPFPIICIifiPCPCCPFPIIffFCPIfFFIfpfIFCIfIiCCpffPCCFFPIiPIFipPIcifpcIpfPCCcIcIfIPCFFccFciFcpPCFcCfICCiCfcCIFcCFcFpfCFcFFcIIipPCpFcPpicFfcFcPFffFfpcpfFfpicFiFpPpPFfIIIIiIfFificIpifcIcFiiFipcpfPCFFipccCpiiPPiIpfPipIfIcpcIpfPCpiPiPIIIpfPCfiPiifcIFpfppfPfFiCppcIiPFiFPifFiPcFcIppFpcfppfpFFpfPpFpiiFpiiCiIfFCFIPcicpiPiIcIfIpfciCIfPppIPCCFppIPiPccFpFPiPiPCPiPFfIfiIIIIPPcIfccpcPpICIpfiIIfcPCfPPcIcFcpcFpIifFFpPfPCfPCcfIiICpcfIPiPciPpIIPiPcCFCccIfFCfIicppIiCifpffPcPcfPciCFcFppFpFcIiFCcPppPifIiipCcPiPFCIPPcIfCPipIpcPCCFiCiipPiiciCcffcFcFCPpCfcppFFcciCipPFpcPiiiipFpfFFfFFpPpcFFCPcpIpICifPFIFFFPPPFFCFFpFFcPicIpIPcfPcpPicciCPcfPpcPIipCppCCPPcFFICpPPPPpiPppcCpCPccFIcPcFFIiPFfFFFcfCIfIFPcCFCFPfIiPIpifpCIiPcpCFPiFPpfcCffCFPfIfciiCPiPFPicCPpicFPFFPIppfIpIppIiiFCIPIfPfIcIifIfpIPpIpiIpfIpIpFfcpCPCFpciPpFFiPicCFPIFiFIccIcfIpIIfCIfCfpPPCFcfCCipcfIIfPIpIPFIIifCCfIpIIppIppIcfIpIIfCIfCfpPPCFicIfpcFFIIfifCcIpFciipFipFpIicIpfIpfpFCICPPipIfpPcipFpIicIpfIpfpFCICIPcCPPIfPFpFpifiPPfIpIIipIPiccfIifCiIfCffCicCcIppIFpiiIIpiIfCPcCcifIiCciiIifPciFciIPFIicFCfCiFIPCciCpCfIfppfIcIipFiIiCcPCIfPiiPICPPiiIifPifccPIpfIfpPcCIfpPciIiCcPCIfPiiPICIPiiIifPifIfpppPIciPIFICCPiPIicPiiIiFcFPipcPipPiPIpCPiiIfpcFPipcccIPipIiPPcCcFfpFIIppIicIfcIifpIccIfIifIpIIffIiIIcccIiCCIpIffiCpPfcffPIPIfppPifCppFIcICpIciCcfIIpIfPFfPfIfiCpPfcICpPifCppFIIfiIfPpIciCcfIIpIfpcfFPFPIFpPfpCfIpppPiPIiIpficfpffcFcpFCIFppPCcPpIfFIiiPiPipcpPFPipPiiipcffCCCFPIiPFffpiPCFCpIFccIifIpiIfcPpPIIIIiiiiPcIiIIFPifcpPIpiPCFiciPCPpPIIpIIppfCcPCCFpiPIiPcCicipFcFFfPiccffifpIiIIpCPicpCIppcIfFPifCPfPiIfpFPifIfPfiFPpFIcipififFIpicpcPfIPiiIpiPIIIpiifcffFIfpPipIiiCPFfFpIiiPIIIfpPCfPiCIiiifcIFIPiPIiIPipIpiCPicfCIpiFPcpcpFcppPPccPPIPFcIcCPPipcCPipiipiciFCccfCCCcCPfIPcCfCFpfCfiiIPIIfFIfFIpIIcIPifFCPIipIcIicPpFfCcFIcCfPcPcFPfpPfPIciPFfcCPPfPPPcIpIPipIicfCICcIcCPPippFiIpIpfPPfPCcPPfCPipIicciFCcIIicPipcCPCcPIicipiiPfIpIFPpIciciFffpcIicCfIiIPPcIfffCIipIcIiPPIIpcPciIffiCPcCfIpcPPcIcIfCIcFpcFFIcIICCIpiICiPIIIcIICCIpiICiPCfPIipPPpPIccFffccIiPPIIiFPciIFpPiPFIiPCFIiFfFPIpiciPIffPCpiPpPFPIfCIpIccfCfcifCIfPCfcIfppPCIipCffcIIPCfPIIcIIfiPPFfIiIPciifFcIIPCpfIfPcifIpifFIpcfPiPFfIiICFpIpcPCfCfiPCfPiIcCpcCiIfpCffPiiIIicIFPififpfCiPfFPiPIpcCfiPiIcCpIfppPCIipCffPiiIiIPIIPiiIiIPCfcCpIppIfFIpIIfcIIIIiiiiPPiPIIFICCIiFPiiPCcpPFPipPfiPfIPfFPipPfiPfIPfFpPFcpfcpfcCpPFIcffIicPFIPiPCIFPiPCfpicpfCPfCPfCPfcPCfpPiPciIfCCCcCPfCPcCfCFpfCfCFPiPPIifpcIpiciiIcFPciIFpPiPFIcfpcIcFPciIcFPccFCIICCIcFCIIIifpFfIipPiIPFPCccpCpICCFpIFpPcCIFiicCfIifPPcFcCcCfIipPPcIcIfCIcFpcFFIcIPIIIcIPCfPIipPPpPIccFffcPiPicFcCpcPIfciPpFIfFIpcIpFIpIPiPfcIPficpfPcIPfFcpfPcIPfFPipPifPcPPiIfcPCfpCfcCccpCpIcFICCPfFcCIIfifCICcIIfiPCpPIIIfipccCcPIfiPCfPIIIfifiPPIicCpcFpCcCPfiPipfCFfciPpFIfFIpcIpFIpIPiPfcIPficpfFffpicPifPcPPiIfcPfCFPiPPIipifIPCicPPipCcFIiCPCCIipPcifiiIifcfPIipcCICcFIffcpcFfcPccfpICfCIipcccIffiPCCfCIffccIiPffpICfCIipcccIifPCppiiCPIIpcPipIfpcpccIIPiFIfpPCpPiiIpccPcIfpCfiPiFIfpPCfpCicPcIfpPCpccIccpiCCIfPPipIcPciipciCfFIcPfFpCfIIcPiCPPIFICCPiPCfFIfPfFpCfIIfPPCfcFPCCiPiPCfFIfPPCfPiiCfIIfPPCpcFPIppccIccpfiICFiIiffPffiiIfIcfPcCIIfccCFfPfcpPIfcPipIifPiPIcIPiIicFccpCPpIcIcpcIcIPIIPiiIcIifccCfIpCfFfPCCfiiIpCccCCPCPipIcPPCCIcFPiPIcPicFPPIIIIcPfICCipfcfPICCPCicIPPipPCicIPfipICCPfIcIPcfPPfIcIPfipICCiFCPCccfPiFCPCcfippCCPippCCCfPCfPPipIPccPfICiFifIIFcPffFCcfCPIcPCCppiPCicpfPipPfFipiICiPIiPCF"

,[[],1],function(z,n){n=n.charCodeAt(0);n=z[1]*8+(n<99?0:4)+n%4;return(n>511?[push(z[0],n%512),1]:[z[0],n])})[0],0],function(z,v){return[z[0].slice(0,836).concat(fold(z[0].slice(836),[],function(l,v){(z[1]+126)%512==v?(l.push(z[0][z[1]*2])+l.push(z[0][z[1]*2+1])):l.push(v);return l})),z[1]+1]})[0].slice(836),"",function(z,v){return(z+String.fromCharCode(v))}))
